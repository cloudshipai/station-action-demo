name: Run Station Agent

on:
  push:
    branches: [main]
  pull_request:
  workflow_dispatch:
    inputs:
      task:
        description: 'Task for the agent'
        required: false
        default: 'List all my dashboards and summarize my analytics setup.'

jobs:
  run-agent:
    name: PostHog Dashboard Reporter
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Run Agent
        uses: cloudshipai/station-action@main
        with:
          agent: 'posthog-dashboard-reporter'
          task: ${{ github.event.inputs.task || 'List all my dashboards and summarize my analytics setup.' }}
          bundle-id: '970fa728-4276-4443-9e51-35919b650d7a'
          cloudship-api-key: ${{ secrets.CLOUDSHIP_API_KEY }}
          debug: 'true'
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          POSTHOG_API_KEY: ${{ secrets.POSTHOG_API_KEY }}
